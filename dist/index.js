"use strict";var mysql=require("mysql"),express=require("express"),bodyParser=require("body-parser"),app=express();app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1}));var connection=mysql.createConnection({host:"localhost",user:"root",password:"123456",database:"ai"});connection.connect(),app.all("*",function(e,o,n){o.header("Access-Control-Allow-Origin","*"),o.header("Access-Control-Allow-Headers","X-Requested-With"),o.header("Access-Control-Allow-Methods","PUT,POST,GET,DELETE,OPTIONS"),o.header("X-Powered-By"," 3.2.1"),o.header("Content-Type","application/json;charset=utf-8"),n()}),app.get("/api/getData",function(e,s){console.log(e.query,111);var o=e.query.name;o?connection.query('SELECT * FROM test WHERE name="'+o+'"',function(e,o,n){e||s.json(o)}):connection.query("SELECT * FROM test",function(e,o,n){e||s.json(o)})}),app.post("/api/addData",function(e,s){console.log(e.body,2222);var o=e.body.name;o?connection.query('INSERT INTO test (name) VALUES ("'+o+'")',function(e,o,n){e?s.json(e):s.json(o)}):s.json({msg:"请输入名称!"})}),app.post("/api/deleteData",function(e,s){console.log(e.body,2222);var o=e.body.id;o?connection.query("DELETE FROM test WHERE id="+o,function(e,o,n){e?s.json(e,"error"):s.json(o)}):s.json({msg:"请选择删除的数据!"})});var server=app.listen(3e3,function(){console.log(server.address())});